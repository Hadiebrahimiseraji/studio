# مستندات کامل پروژه فروشگاه اینترنتی پایپ (BuildMart Online)

این مستندات به شما کمک می‌کند تا درک عمیقی از معماری، ساختار و نحوه‌ی عملکرد پروژه به دست آورید.

## ۱. نمای کلی و معماری

**پروژه‌ی پایپ (BuildMart Online)** یک پلتفرم کامل فروشگاه اینترنتی برای فروش تجهیزات و لوازم تأسیساتی است. این پروژه با معماری **فول‌استک** پیاده‌سازی شده و شامل دو بخش اصلی است:

-   **بک‌اند (Backend):** با استفاده از **Django** و **Django REST Framework** توسعه داده شده است. این بخش مسئولیت مدیریت داده‌ها، منطق کسب‌وکار و ارائه‌ی یک API قدرتمند را بر عهده دارد.
-   **فرانت‌اند (Frontend):** با استفاده از **Next.js** (یک فریم‌ورک React)، **TypeScript** و **Tailwind CSS** ساخته شده است. این بخش مسئول نمایش رابط کاربری به کاربران است.

ارتباط بین این دو بخش از طریق یک **API RESTful** برقرار می‌شود. فرانت‌اند درخواست‌های HTTP (مانند دریافت لیست محصولات) را به بک‌اند ارسال می‌کند و بک‌اند پاسخ را در قالب **JSON** برمی‌گرداند.

---

## ۲. ساختار و درخت پروژه

ساختار پوشه‌های پروژه به شکل زیر سازماندهی شده است:

```
/
├── finalthesis/
│   ├── buildmart-online/
│   │   ├── backend/            #<-- کدهای بک‌اند Django
│   │   └── ...                 # (پوشه‌های دیگر مربوط به Django)
│   └── database/
│       ├── image/              #<-- تصاویر محصولات در پوشه‌های 1, 2, 3, 4
│       └── space/
│           └── sample_products.json #<-- داده‌های اولیه محصولات
├── src/
│   ├── app/                    #<-- صفحات و مسیریابی فرانت‌اند (Next.js App Router)
│   ├── components/             #<-- کامپوننت‌های قابل استفاده مجدد React
│   └── lib/                    #<-- کدهای کمکی فرانت‌اند (API, Types)
├── public/                     #<-- فایل‌های استاتیک فرانت‌اند
├── package.json                #<-- وابستگی‌ها و اسکریپت‌های فرانت‌اند
└── README.md                   #<-- همین فایل راهنما
```

---

## ۳. بررسی عمیق بخش‌ها

### الف) بک‌اند (Django)

-   **مکان:** `finalthesis/buildmart-online/backend/`
-   **تکنولوژی اصلی:** `Python`, `Django`, `Django REST Framework`, `SQLite`

بک‌اند قلب تپنده‌ی سیستم است و وظایف زیر را انجام می‌دهد:

1.  **مدیریت پایگاه داده:**
    -   مدل‌های داده (مانند `Product`, `Category`, `ProductImage`) در فایل‌های `models.py` هر اپلیکیشن (مثلاً `apps/catalog/models.py`) تعریف شده‌اند. این مدل‌ها ساختار جداول پایگاه داده را مشخص می‌کنند.

2.  **ارائه API RESTful:**
    -   با استفاده از `Django REST Framework`، داده‌های پایگاه داده به فرمت JSON تبدیل شده و از طریق URLهای مشخصی در دسترس فرانت‌اند قرار می‌گیرند.
    -   **Serializerها** (مانند `apps/catalog/serializers.py`) مسئول تبدیل مدل‌های پیچیده‌ی پایتون به JSON هستند.
    -   **Viewها** (مانند `apps/catalog/views.py`) منطق هر API را مدیریت می‌کنند (مثلاً دریافت تمام محصولات یا یک محصول خاص).
    -   **URLها** (مانند `apps/catalog/urls.py`) مسیرهای API را تعریف می‌کنند (مثلاً `/api/catalog/products/`).

3.  **مدیریت فایل‌ها و تصاویر:**
    -   در فایل `settings/base.py`، متغیر `MEDIA_ROOT` طوری تنظیم شده که به پوشه‌ی `finalthesis/database/` اشاره کند.
    -   این به Django اجازه می‌دهد تا تصاویر محصولات را مستقیماً از این پوشه به فرانت‌اند سرویس دهد.

4.  **اسکریپت‌های مدیریتی (بسیار مهم):**
    -   `create_brand_categories.py`: یک اسکریپت سفارشی برای ایجاد دسته‌بندی‌ها و برندهای اولیه در پایگاه داده.
    -   `import_products_json.py`: **مهم‌ترین اسکریپت برای شروع کار.** این اسکریپت فایل `sample_products.json` را می‌خواند و تمام محصولات، همراه با اطلاعات و مسیر تصاویرشان، را به صورت خودکار وارد پایگاه داده می‌کند.

### ب) فرانت‌اند (Next.js)

-   **مکان:** ریشه‌ی اصلی پروژه (پوشه‌ی `src/`)
-   **تکنولوژی اصلی:** `React`, `Next.js`, `TypeScript`, `Tailwind CSS`

فرانت‌اند چهره‌ی وب‌سایت شماست و مسئولیت‌های زیر را بر عهده دارد:

1.  **ساختار صفحات (App Router):**
    -   در پوشه‌ی `src/app/`، هر پوشه نمایانگر یک مسیر (URL) در سایت است.
    -   `app/layout.tsx`: فایل اصلی که ساختار کلی همه‌ی صفحات (مانند هدر و فوتر) را تعریف می‌کند.
    -   `app/page.tsx`: صفحه‌ی اصلی سایت (`/`).
    -   `app/products/page.tsx`: صفحه‌ی لیست تمام محصولات (`/products`).
    -   `app/products/[id]/page.tsx`: صفحه‌ی نمایش جزئیات یک محصول خاص. `[id]` یک پارامتر داینامیک است.

2.  **کامپوننت‌ها (Components):**
    -   در پوشه‌ی `src/components/`، قطعات قابل استفاده مجدد UI قرار دارند. برای مثال `ProductCard.tsx` یک کارت زیبا برای نمایش خلاصه‌ی محصول است که در چندین صفحه استفاده می‌شود.

3.  **اتصال به بک‌اند (API Calls):**
    -   این بخش **مهم‌ترین نقطه‌ی اتصال** دو دنیاست.
    -   در فایل `src/lib/api.ts` توابعی نوشته شده‌اند که به API بک‌اند Django درخواست ارسال می‌کنند.
    -   برای مثال، تابع `getProducts()` یک درخواست `GET` به آدرس `http://127.0.0.1:8000/api/catalog/products/` ارسال کرده و لیست محصولات را در قالب JSON دریافت می‌کند.
    -   تابع `getFullImageUrl()` مسیر نسبی تصویر دریافتی از بک‌اند (مثلاً `/media/image/1/p-13877.jpg`) را به یک URL کامل (`http://127.0.0.1:8000/media/image/1/p-13877.jpg`) تبدیل می‌کند تا در تگ `<img>` قابل استفاده باشد.

4.  **مدیریت انواع داده (TypeScript):**
    -   در فایل `src/lib/types.ts`، ساختار داده‌هایی که از بک‌اند دریافت می‌شوند (مانند `Product`, `Category`) با TypeScript تعریف شده‌اند. این کار از بروز بسیاری از خطاها جلوگیری کرده و کدنویسی را آسان‌تر می‌کند.

5.  **استایل‌دهی (Tailwind CSS):**
    -   به جای نوشتن کدهای CSS سنتی، از کلاس‌های آماده‌ی Tailwind برای استایل‌دهی سریع و واکنش‌گرا (Responsive) استفاده می‌شود. تنظیمات اختصاصی مانند رنگ‌ها و فونت‌ها در `tailwind.config.ts` قرار دارد.

---

## ۴. جریان داده از بک‌اند به فرانت‌اند (یک مثال کامل)

بیایید ببینیم وقتی کاربر صفحه‌ی محصولات را باز می‌کند، چه اتفاقی می‌افتد:

1.  **شروع در بک‌اند:** شما دستور `python manage.py import_products_json` را اجرا می‌کنید. بک‌اند فایل `sample_products.json` را خوانده و محصولات را همراه با مسیر تصاویرشان در پایگاه داده SQLite ذخیره می‌کند.
2.  **درخواست از فرانت‌اند:** کاربر آدرس `/products` را در مرورگر وارد می‌کند. صفحه‌ی `src/app/products/page.tsx` در Next.js اجرا می‌شود.
3.  **فراخوانی API:** این صفحه، تابع `getProducts()` را از فایل `src/lib/api.ts` فراخوانی می‌کند.
4.  **ارتباط با بک‌اند:** تابع `getProducts` یک درخواست HTTP GET به API بک‌اند در آدرس `http://127.0.0.1:8000/api/catalog/products/` ارسال می‌کند.
5.  **پاسخ از بک‌اند:** Django این درخواست را دریافت کرده، به پایگاه داده متصل شده، لیست محصولات را استخراج کرده و با استفاده از `ProductSerializer`، آن‌ها را به یک رشته‌ی طولانی JSON تبدیل و به عنوان پاسخ به فرانت‌اند ارسال می‌کند.
6.  **نمایش در فرانت‌اند:**
    -   فرانت‌اند پاسخ JSON را دریافت می‌کند.
    -   کامپوننت صفحه، روی لیست محصولات حلقه می‌زند و به ازای هر محصول، یک کامپوننت `ProductCard` را رندر می‌کند.
    -   `ProductCard` با استفاده از تابع `getFullImageUrl`، آدرس تصویر را به یک URL معتبر تبدیل کرده و آن را در یک تگ `<img>` نمایش می‌دهد.
    -   در نهایت، کاربر لیستی زیبا از محصولات را در مرورگر خود مشاهده می‌کند.

---

## ۵. راهنمای راه‌اندازی پروژه (قدم به قدم برای مبتدیان)

این راهنما به شما کمک می‌کند تا پروژه را قدم‌به‌قدم روی کامپیوتر خودتان بالا بیاورید.

### قدم اول: نصب نیازمندی‌های اولیه

قبل از هر چیز، باید ابزارهای زیر روی سیستم شما نصب باشند:

1.  **Python**: برای اجرای بک‌اند (سرور Django).
    -   می‌توانید آن را از [وب‌سایت رسمی پایتون](https://www.python.org/downloads/) دانلود و نصب کنید. (نسخه ۳.۸ یا بالاتر توصیه می‌شود)
2.  **Node.js و npm**: برای اجرای فرانت‌اند (وب‌سایت Next.js).
    -   با نصب Node.js از [وب‌سایت رسمی آن](https://nodejs.org/)، `npm` نیز به صورت خودکار نصب می‌شود. (نسخه ۱۸ یا بالاتر توصیه می‌شود)
3.  **Git**: برای دانلود کد پروژه (اگر از Git استفاده می‌کنید).

---

### قدم دوم: راه‌اندازی بک‌اند (سرور Django)

حالا سرور بک‌اند را راه‌اندازی می‌کنیم. این سرور مسئول مدیریت داده‌های محصولات است.

**یک ترمینال جدید باز کنید** و مراحل زیر را دنبال کنید:

1.  **وارد پوشه بک‌اند شوید:**
    ```bash
    cd finalthesis/buildmart-online/backend
    ```

2.  **یک محیط مجازی (Virtual Environment) برای پایتون بسازید:**
    این کار کمک می‌کند تا پکیج‌های این پروژه با پروژه‌های دیگر شما تداخل نداشته باشند.
    ```bash
    python -m venv venv
    ```

3.  **محیط مجازی را فعال کنید:**
    -   در ویندوز:
        ```cmd
        venv\Scripts\activate
        ```
    -   در مک یا لینوکس:
        ```bash
        source venv/bin/activate
        ```
    بعد از اجرای این دستور، باید ابتدای خط ترمینال شما عبارت `(venv)` اضافه شده باشد.

4.  **بسته‌های مورد نیاز پایتون را نصب کنید:**
    ```bash
    pip install -r requirements.txt
    ```

5.  **پایگاه داده را ایجاد کنید:**
    این دستور جداول مورد نیاز برنامه را در یک فایل پایگاه داده SQLite ایجاد می‌کند.
    ```bash
    python manage.py migrate
    ```

6.  **داده‌های اولیه را وارد پایگاه داده کنید (بسیار مهم):**
    این دو دستور، دسته‌بندی‌ها، برندها و محصولات نمونه را به صورت خودکار به پایگاه داده اضافه می‌کنند. **هر بار که خواستید داده‌ها را از نو بسازید، این دو دستور را اجرا کنید.**
    ```bash
    python manage.py create_brand_categories
    python manage.py import_products_json
    ```

7.  **سرور بک‌اند را اجرا کنید:**
    ```bash
    python manage.py runserver
    ```

عالی! سرور بک‌اند شما حالا روی آدرس `http://127.0.0.1:8000` در حال اجراست. **این ترمینال را باز نگه دارید** و به مرحله بعد بروید.

---

### قدم سوم: راه‌اندازی فرانت‌اند (سایت Next.js)

حالا سایت اصلی که کاربران می‌بینند را راه‌اندازی می‌کنیم. **یک ترمینال جدید دیگر باز کنید** (ترمینال قبلی باید برای بک‌اند باز بماند).

1.  **وارد پوشه اصلی پروژه شوید:**
    مطمئن شوید که در ریشه اصلی پروژه هستید (جایی که فایل `package.json` قرار دارد).

2.  **بسته‌های مورد نیاز جاوااسکریپت را نصب کنید:**
    این دستور تمام کتابخانه‌هایی که برای نمایش ظاهر سایت لازم است را نصب می‌کند.
    ```bash
    npm install
    ```

3.  **سرور فرانت‌اند را اجرا کنید:**
    ```bash
    npm run dev
    ```

فوق‌العاده! سرور فرانت‌اند شما حالا روی آدرس `http://localhost:9002` در حال اجراست.

---

### قدم چهارم: مشاهده وب‌سایت

حالا می‌توانید مرورگر وب خود را باز کرده و با وارد کردن آدرس زیر، وب‌سایت را مشاهده کنید:

[http://localhost:9002](http://localhost:9002)

برای اینکه سایت به درستی کار کند، **هر دو سرور بک‌اند و فرانت‌اند باید همزمان در حال اجرا باشند.** موفق باشید!
